<!DOCTYPE html>
<html>

<head>
    <title>Google Route</title>
    <meta charset="utf-8" />
    <script type='text/javascript'>
        var data = [
            { name: 'Rought1', val: [{ address: 'Stop 0', lang: '33.64188', late: '-84.50077' }, { address: 'Stop 1', lang: '33.76768', late: '-84.36031' }] },
            { name: 'Rought2', val: [{ address: 'Stop 2', lang: '34.6477', late: '-84.2266' }, { address: 'Stop 3', lang: '33.64188', late: '-84.50077' }] }
        ]
        function directionsUpdated(e) {
            var routeIdx = directionsManager.getRequestOptions().routeIndex;
            var distance = Math.round(e.routeSummary[routeIdx].distance * 100) / 100;
            var units = directionsManager.getRequestOptions().distanceUnit;
            var distanceUnits = '';
            if (units == Microsoft.Maps.Directions.DistanceUnit.km) {
                distanceUnits = 'km'
            } else {
                distanceUnits = 'miles'
            }
            var time = Math.round(e.routeSummary[routeIdx].timeWithTraffic / 60);
            document.getElementById('routeInfoPanel').innerHTML = 'Distance: ' + distance + ' ' + distanceUnits + '<br/>Time with Traffic: ' + time + ' minutes';
        }
        function directionsError(e) {
            alert('Error: ' + e.message + '\r\nResponse Code: ' + e.responseCode)
        }
        var map;
        var routeId;
        function loadMap() {
            if (!map) {
                var mapScriptUrl = 'https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=ArJkybJp6LvcJs7su6sKIQMBnwYngXlhGIjE5aWRApleSq6DkWzGNm5j80Lb-WZt';
                var script = document.createElement("script");
                script.setAttribute('defer', '');
                script.setAttribute('async', '');
                script.setAttribute("type", "text/javascript");
                script.setAttribute("src", mapScriptUrl);
                document.body.appendChild(script);
            }
        }
        function GetMap() {
            var routeId = document.getElementById("mySelectRoute").value;
            map = new Microsoft.Maps.Map('#myMap', {})
            Microsoft.Maps.loadModule('Microsoft.Maps.Directions', function () {
                directionsManager = new Microsoft.Maps.Directions.DirectionsManager(map);
                for (var i = 0; i < data[routeId].val.length; i++) {
                    var StopWaypoint = new Microsoft.Maps.Directions.Waypoint({ address: data[routeId].val[i].address, location: new Microsoft.Maps.Location(data[routeId].val[i].lang, data[routeId].val[i].late) });
                    directionsManager.addWaypoint(StopWaypoint);
                }
                Microsoft.Maps.Events.addHandler(directionsManager, 'directionsError', directionsError);
                Microsoft.Maps.Events.addHandler(directionsManager, 'directionsUpdated', directionsUpdated);
                directionsManager.calculateDirections();
            })
        }
    </script>
</head>

<body onload="loadMap()">
    <div id="selectID"></div>
    <div id="myMap" style="position:relative;width:800px;height:600px;"></div>
    <div id="routeInfoPanel"></div>
</body>
<script>
    function rander() {
        var element = '<select id="mySelectRoute" onchange="GetMap()">'
        for (var i = 0; i < data.length; i++) {
            element = element + '<option value="' + i + '">' + data[i].name + ''
        }
        element = element + '</select>'
        document.getElementById("selectID").innerHTML = element
    }
    rander()
    loadMap()
</script>

</html>